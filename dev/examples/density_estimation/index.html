<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Density estimation · AutoHist.jl</title><meta name="title" content="Density estimation · AutoHist.jl"/><meta property="og:title" content="Density estimation · AutoHist.jl"/><meta property="twitter:title" content="Density estimation · AutoHist.jl"/><meta name="description" content="Documentation for AutoHist.jl."/><meta property="og:description" content="Documentation for AutoHist.jl."/><meta property="twitter:description" content="Documentation for AutoHist.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="AutoHist.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="AutoHist.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AutoHist.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../methods/">Supported Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../plotting/">Plotting tutorial</a></li><li class="is-active"><a class="tocitem" href>Density estimation</a><ul class="internal"><li><a class="tocitem" href="#Estimating-the-LogNormal-probability-density"><span>Estimating the LogNormal probability density</span></a></li><li><a class="tocitem" href="#Mode-hunting"><span>Mode hunting</span></a></li></ul></li><li><a class="tocitem" href="../algorithm_choice/">Choice of algorithm</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../algorithms/">Algorithms</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Density estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Density estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/oskarhs/AutoHist.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/oskarhs/AutoHist.jl/blob/main/docs/src/examples/density_estimation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Density-estimation"><a class="docs-heading-anchor" href="#Density-estimation">Density estimation</a><a id="Density-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Density-estimation" title="Permalink"></a></h1><p>The following document illustrates the use of AutoHist.jl through examples from the world of density estimation. In particular, we showcase some of the relative advantages and disadvantages of regular and irregular histogram procedures.</p><h2 id="Estimating-the-LogNormal-probability-density"><a class="docs-heading-anchor" href="#Estimating-the-LogNormal-probability-density">Estimating the LogNormal probability density</a><a id="Estimating-the-LogNormal-probability-density-1"></a><a class="docs-heading-anchor-permalink" href="#Estimating-the-LogNormal-probability-density" title="Permalink"></a></h2><p>We start by considering an example with some simulated data from the <a href="https://en.wikipedia.org/wiki/Log-normal_distribution">LogNormal-distribution</a>. To start, we fit a regular histogram to the data, using the approach of <a href="https://doi.org/10.1016/j.csda.2010.04.021">Birgé and Rozenholc (2006)</a>, which corresponds to <code>rule=BR()</code>.</p><pre><code class="language-julia hljs">using AutoHist, Random, Distributions
x = rand(Xoshiro(1812), LogNormal(), 10^4)
h1 = fit(AutomaticHistogram, x, BR())</code></pre><p>Alternatively, since the standard LogNormal pdf has known support <span>$[0,\infty)$</span>, we can incorporate this knowledge in our histogram estimate through the <code>support</code> keyword.</p><pre><code class="language-julia hljs">h2 = fit(AutomaticHistogram, x, BR(); support=(0.0, Inf))</code></pre><p>To quantify the difference of using the correct, known support in this case, we compute the integrated absolute error between the two densities in the following code snippet, which is given by <span>$\int |f(x) - g(x)|\text{d}x$</span>.</p><pre><code class="language-julia hljs">distance(h1, h2, :iae)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.04206469472280519</code></pre><p>The resulting <span>$L_1$</span> distance of <span>$0.042$</span> indicates that the new bin origin at <span>$0$</span> has a moderate effect on the resulting density estimate.</p><p>The standard LogNormal is quite challenging to estimate well using a regular histogram procedure due to its heavy tails. These two factors make irregular methods an appealing alternative in this case. Here, we use the penalized log-likelihood approach from <a href="https://doi.org/10.1016/j.csda.2010.04.021">Rozenholc et al. (2010)</a> with penalty R and a data-based grid to construct the histogram, (implemented in AutoHist.jl via <code>rule = RMG_penR()</code>).</p><pre><code class="language-julia hljs">h3 = fit(AutomaticHistogram, x, RMG_penR(grid=:data))</code></pre><p>To compare the two approaches, we can plot the resulting histograms along with the true density:</p><img src="4db42577.svg" alt="Example block output"/><p>The irregular procedure selects smaller bin widths near the origin, reflecting the fact that the LogNormal density is rapidly changing in this area. On the other hand, the bin widths are larger in the flatter region in the right tail of the density. Both histogram procedures provide quite reasonable estimates of the density, owing to the fairly large sample size.</p><h2 id="Mode-hunting"><a class="docs-heading-anchor" href="#Mode-hunting">Mode hunting</a><a id="Mode-hunting-1"></a><a class="docs-heading-anchor-permalink" href="#Mode-hunting" title="Permalink"></a></h2><p>In an exploratory data analysis setting, identifying key features in a dataset such as modes is frequently of great interest to statisticians and practitioners alike. Unfortunately, most popular regular histogram have been designed with good performance in terms of statistical risk with respect to classical, integral-based loss functions, which typically results in a large amount of spurious histogram modes in regions where the true density is flat and in the tails of the density <a href="https://doi.org/10.1002/9780470316849">(Scott, 1992)</a>. In practice, this means that a data-analyst must use subjective judgement to infer whether a regular histogram estimate is indicative of a mode being present or not. If the presence of a mode is deemed likely, subjective visual smoothing is typically required to get a rough idea of its location. In contrast, some irregular histogram procedures have been shown empirically to perform quite well with regard to automatic mode detection in cases where the true density has a smallish amount of well-separated modes, see e.g. <a href="https://doi.org/10.1051/ps:2008005">Davies et al. (2009)</a>; <a href="https://doi.org/10.1093/biomet/asz081">Li et al. (2020)</a>; <a href="https://doi.org/10.48550/ARXIV.2505.22034">Simensen et al. (2025)</a>.</p><p>To illustrate the advantage of irregular histograms when it comes to mode identification, we will consider an example where we attempt to locate the modes of the Harp density of <a href="https://doi.org/10.1093/biomet/asz081">Li et al. (2020)</a>, plotted below.</p><img src="fbb048b0.svg" alt="Example block output"/><p>The Harp density has 5 peaks with varying degrees of sharpness, with the location of each mode becoming gradually more difficult to locate in absolute terms as we move rightward on the <span>$x$</span>-axis. In the numerical experiment to follow, we generate a random sample of size <span>$n = 5000$</span> from the Harp density, and fit both an irregular and a regular histogram to the data. Motivated by the results of the simulation studies in <a href="https://doi.org/10.1051/ps:2008005">Davies et al. (2009)</a> and <a href="https://doi.org/10.48550/ARXIV.2505.22034">Simensen et al. (2025)</a>, we have used the BIC criterion to draw the regular histogram, and the random irregular histogram method (<code>rule=RIH()</code>), as both of these have been shown to perform relatively well compared to their respective regular/irregular counterparts in automatic mode identification. To access the Harp distribution, we use the TestDistributions package, which can be found in <a href="https://github.com/oskarhs/Random-Histograms---Paper/tree/main/TestDistributions">the following github repository</a>.</p><pre><code class="language-julia hljs">import TestDistributions as TD
using AutoHist, Distributions, Random
x = rand(Xoshiro(1812), TD.Harp(), 5000)

h_reg = fit(AutomaticHistogram, x, BIC())
h_irr = fit(AutomaticHistogram, x, RIH())</code></pre><p>We can now add the two fitted histograms along with the location of their modes to the plot of the Harp density above:</p><img src="426e500b.svg" alt="Example block output"/><p>The spatial inhomogeneity of the Harp density causes some trouble for the regular histogram, as the use of a global bin width leads to undersmoothing near the sharpest mode and oversmoothing near the flattest mode and in the tails. In particular, the regular estimate introduces many spurious modes near the rightmost mode of the true density, making it difficult to exactly infer the location and the number of modes in the region surrounding it. In contrast, the irregular histogram estimate is able to correctly infer the number of modes in the density automatically, with no subjective judgments required. The good mode-finding behavior is in this case enabled by the fact that the bin widths are able adapt to the local smoothness of the true density, resulting in more smoothing near modes. To inspect the accuracy of the inferred modes, we print the locations of the true modes and the peaks of the irregular histogram.</p><pre><code class="language-julia hljs">println(&quot;True modes: &quot;, TD.Harp() |&gt; TD.peaks |&gt; x -&gt; round.(x; digits=2))
println(&quot;AutoHist modes: &quot;, h_irr |&gt; peaks |&gt; x -&gt; round.(x; digits=2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">True modes: [0.0, 5.0, 15.0, 30.0, 60.0]
AutoHist modes: [-0.09, 5.28, 14.9, 30.2, 60.64]</code></pre><p>We observe that all of the histogram peaks are quite close to a corresponding true mode, especially when taking the sharpness of each individual peak into account.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../plotting/">« Plotting tutorial</a><a class="docs-footer-nextpage" href="../algorithm_choice/">Choice of algorithm »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Thursday 18 September 2025 11:17">Thursday 18 September 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
